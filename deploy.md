# Deploy Guide: NextMile Telegram WebApp

–ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –ø—Ä–æ—Ç–æ—Ç–∏–ø–∞ NextMile: –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (Supabase), backend-–±–æ—Ç (Telegram), frontend (Next.js WebApp), –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è.

---

## 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone <URL-–í–ê–®–ï–ì–û-–†–ï–ü–û–ó–ò–¢–û–†–ò–Ø>
cd NextMileApp
```

---

## 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Supabase (–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ [supabase.com](https://supabase.com/) –∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç.
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Table Editor** –∏–ª–∏ **SQL Editor**.
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL-–∫–æ–¥ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü:

```sql
-- Goals
create table if not exists public.goals (
  id bigint generated by default as identity primary key,
  title text not null,
  category text not null,
  deadline date not null,
  progress integer default 0
);

-- Tasks
create table if not exists public.tasks (
  id bigint generated by default as identity primary key,
  title text not null,
  goal_id bigint references public.goals(id) on delete cascade,
  complexity text,
  status text default 'todo'
);

-- Plans
create table if not exists public.plans (
  id bigint generated by default as identity primary key,
  goal_id bigint references public.goals(id) on delete cascade,
  sprint integer not null,
  description text not null
);
```

4. (–ï—Å–ª–∏ –≤–∫–ª—é—á—ë–Ω RLS) –î–æ–±–∞–≤—å—Ç–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è –∞–Ω–æ–Ω–∏–º–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

```sql
create policy "Allow anon insert/select on goals"
  on public.goals
  for all
  using (true)
  with check (true);

create policy "Allow anon insert/select on tasks"
  on public.tasks
  for all
  using (true)
  with check (true);

create policy "Allow anon insert/select on plans"
  on public.plans
  for all
  using (true)
  with check (true);
```

5. –ü–æ–ª—É—á–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è:
   - **Project URL** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `https://xxxx.supabase.co`)
   - **anon public key** (—Ä–∞–∑–¥–µ–ª Project Settings ‚Üí API)

---

## 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env.local` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```
NEXT_PUBLIC_SUPABASE_URL=–í–ê–®_SUPABASE_URL
NEXT_PUBLIC_SUPABASE_ANON_KEY=–í–ê–®_SUPABASE_ANON_KEY
```

---

## 4. –î–µ–ø–ª–æ–π –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram-–±–æ—Ç–∞ (Backend)

1. –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ [@BotFather](https://t.me/BotFather) –∏ –ø–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω.
2. –†–µ–∞–ª–∏–∑—É–π—Ç–µ backend-–±–æ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞ Node.js —Å telegraf –∏–ª–∏ –Ω–∞ Python —Å aiogram). –ü—Ä–∏–º–µ—Ä –¥–ª—è Node.js:

```js
const { Telegraf } = require('telegraf');
const bot = new Telegraf(process.env.BOT_TOKEN);

bot.start((ctx) => {
  ctx.reply('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –û—Ç–∫—Ä–æ–π—Ç–µ WebApp:', {
    reply_markup: {
      keyboard: [[{ text: '–û—Ç–∫—Ä—ã—Ç—å NextMile', web_app: { url: 'https://–í–ê–®_–î–û–ú–ï–ù.vercel.app' } }]],
      resize_keyboard: true,
      one_time_keyboard: true,
    },
  });
});

bot.launch();
```

3. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –±–æ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `.env`):
```
BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞
```

4. –ó–∞–¥–µ–ø–ª–æ–π—Ç–µ –±–æ—Ç–∞ –Ω–∞ –ª—é–±–æ–π —Å–µ—Ä–≤–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, Render, Railway, Heroku, VPS).

---

## 5. –î–µ–ø–ª–æ–π Frontend (Next.js WebApp)

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
npm install
```
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É –ª–æ–∫–∞–ª—å–Ω–æ:
```bash
npm run dev
```
3. –ó–∞–¥–µ–ø–ª–æ–π—Ç–µ –Ω–∞ [Vercel](https://vercel.com/) (–∏–ª–∏ –¥—Ä—É–≥–æ–π —Ö–æ—Å—Ç–∏–Ω–≥):
   - –ü–æ–¥–∫–ª—é—á–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.
   - –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞ –¥–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–∑ `.env.local`.
   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–µ–ø–ª–æ–π.

---

## 6. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è WebApp —Å Telegram-–±–æ—Ç–æ–º

1. –í –∫–æ–¥–µ –±–æ—Ç–∞ —É–∫–∞–∂–∏—Ç–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–π URL –≤–∞—à–µ–≥–æ WebApp (–Ω–∞–ø—Ä–∏–º–µ—Ä, `https://nextmile.vercel.app`).
2. –í Telegram –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É "–û—Ç–∫—Ä—ã—Ç—å NextMile" ‚Äî WebApp –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ Telegram.

---

## 7. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

- –°–æ–∑–¥–∞–π—Ç–µ —Ü–µ–ª—å —á–µ—Ä–µ–∑ WebApp ‚Äî –æ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –≤ Supabase.
- –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ü–µ–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—è–≤–∏—Ç—Å—è –ø–ª–∞–Ω –∏–∑ 3 —Å–ø—Ä–∏–Ω—Ç–æ–≤.
- Dashboard –ø–æ–∫–∞–∂–µ—Ç –≤–∞—à–∏ —Ü–µ–ª–∏ –∏ –∑–∞–¥–∞—á–∏ –Ω–∞ –¥–µ–Ω—å.
- WebApp –¥–æ–ª–∂–µ–Ω –æ—Ç–∫—Ä—ã–≤–∞—Ç—å—Å—è –ø–æ –∫–Ω–æ–ø–∫–µ –≤ Telegram-–±–æ—Ç–µ.

---

## 8. Troubleshooting

- **404 Not Found –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å Supabase:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã –∏ –Ω–∞–∑–≤–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ.
- **–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ü–µ–ª–∏:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (RLS) –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.
- **WebApp –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ Telegram:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ URL —É–∫–∞–∑–∞–Ω –≤ web_app –∫–Ω–æ–ø–∫–µ –±–æ—Ç–∞.
- **–ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –∏ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞, –≥–¥–µ –æ–Ω –∑–∞–ø—É—â–µ–Ω.

---

## 9. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ
- –î–ª—è production —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–æ—Å—Ç—É–ø–∞ Supabase –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
- –î–ª—è AI-–ø–ª–∞–Ω–∞ –º–æ–∂–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π AI-—Å–µ—Ä–≤–∏—Å (OpenAI API –∏ –¥—Ä.).

---

**–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏, –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –∏ –ª–æ–≥–∏ Supabase.**

---

**–£–¥–∞—á–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è!** üöÄ 